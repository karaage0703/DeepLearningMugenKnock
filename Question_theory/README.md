# Q. 理論編

ここではディープラーニングの理論をnumpyを使って自分の手で実装していきます。わからないと無限に泥沼にはまってしまいやすいので、ちょっと答えを見たりしてコーディングしてみましょう。

## Q. パーセプトロン Step.1

パーセプトロンは人の脳にある神経細胞、ニューロンを数式モデリングしたものです。その仕組は入力値それぞれに重みというパラメータを乗算し、それを加算して出力するシンプルなものです。

![](assets/perceptron.jpg)

ｂはバイアスと呼ばれ、ただ、数値を加算するだけの仕組みです。

なので、入力が[x1, x2], 重みが[w1, w2], y = w1 x1 + w2 x2 + b という式ですが、bを w3 x 1 という風に見てやると、入力1に重みw3をかけたものと見なせます。
よって、入力が[x1, x2, 1] , 重みが[w1, w2, w3],  y = w1 x1 + w2 x2 + w3 x3 という風に変換することができます。

ここではパーセプトロンで下記のクラス分類を解きます。まずはこれを実装しましょう。

| 入力 | 出力（クラス）|
|:---:|:---:|
| [0, 0] | -1 |
| [0, 1] | -1 |
| [1, 0] | -1 |
| [1, 1] | 1 |

これはこんな風に書きます。

```python
x = np.array([[0,0], [0,1], [1,0], [1,1]], dtype=np.float32)
t = np.array([[-1], [-1], [-1], [1]], dtype=np.float32)
```
重みはこれを用いて下さい。

```python
import numpy as np
np.random.seed(0)
w = np.random.normal(0., 1, (3))
```

次に、入力にバイアス用の[1]を追加して、それぞれ y の値を計算してみましょう。

こういう結果になると思います。

```bash
weight >> [1.76405235 0.40015721 0.97873798]
in >> [0. 0. 1.] y >> 0.9787379841057392
in >> [0. 1. 1.] y >> 1.3788951924729624
in >> [1. 0. 1.] y >> 2.742790330073403
in >> [1. 1. 1.] y >> 3.1429475384406267
```

答え >> [perceptron1.py]( https://github.com/yoyoyo-yo/DeepLearningMugenKnock/blob/master/Question_theory/perceptron1.py )

## Q. パーセプトロン Step.2

出力が得られたら、次に学習を行っていきます。
そもそも学習というのはパラメータの自動更新をいいます。ここでいうパラメータとは重みのことです（バイアスもめんどいので重みとして扱います）。

重みをどうやって更新するかというと、出力を見るわけです。今回の問題は最後の出力が-1か1なので２クラス分類という問題に回帰されます。ですが、先程の出力を見ると、0.9787とかになってます。こういうときは、出力が0以上を1、0未満を-1という風に考えて、問題にフィットさせます。（こういう操作は活性化関数と呼ばれるもので操作されていきますが、これは後々）

パーセプトロンでは、出力が逆だった場合、En = ラベル x 入力値　 を重みの更新料とします。（Enは**誤差関数**と呼ばれます。）
つまり、重み w に対して、w = w - lr En を計算します。 lrは学習率といい、更新の度合いを表します。0.1や0.01など[0,1]の範囲を取ります。

これを全てのデータに対して更新がなくなるまで、延々と繰り返します。これが学習です。ディープラーニングはこの学習をめちゃくちゃやってすごい成果を出しています。

学習のアルゴリズムは、
1. ４つの入力xに対する出力yを計算
2. yが逆のクラスを指していたら、 En = 正しいラベル x 入力値　を計算
3. w = w - lr En を計算する
4. 2と3を全てのデータで更新がされなくなるまで、４つのデータで繰り返す。
ここではlr=0.1として、これを学習を行ってみましょう。

答え >> [perceptron2.py]( https://github.com/yoyoyo-yo/DeepLearningMugenKnock/blob/master/Question_theory/perceptron2.py )
